import subprocess
import platform


def win_search(wmic, product, get, query):
    Data = subprocess.check_output([wmic, product, get, query])
    a = str(Data)
    lst = []

    try:
        for i in range(len(a)):
            tmp = a.split("\\r\\r\\n")[i].rstrip()
            lst.append(tmp)
    except IndexError as e:
        print("All Done")

    lst.pop(0) #Deleting title of list
    return lst

current_os = platform.system() #Determening current OS

def get_win():
    name = win_search('wmic', 'product', 'get', 'name')
    version = win_search('wmic', 'product', 'get', 'version')
    return name, version

def get_linux():
    if current_os == 'Darwin':
        Data = subprocess.check_output('ps', 'axc', '|', 'sed', '"s/.*:..... /\"/"', '|', 'sed', 's/$/\"/')
        a = str(Data)
        name = []
        try:
            for i in range(len(a)):
                tmp = a.split("\\r\\r\\n")[i].rstrip()
                name.append(tmp)
        except IndexError as e:
            print("All Done")
    else:
        Data = subprocess.check_output('ps -eo cmd')
        a = str(Data)
        name = []
        try:
            for i in range(len(a)):
                tmp = a.split("\\r\\r\\n")[i].rstrip()
                name.append(tmp)
        except IndexError as e:
            print("All Done")

    return name

# 'ps axc | sed "s/.*:..... /\"/" | sed s/$/\"/'



# Notes:
# Experimented with Popen and os
# Experimented with commandline prompts
# os depreciated, move to subprocess
#Program should not have application_ignore_list for safety reasons

# Depreciated search function
#s1 = subprocess.Popen('wmic product get name', shell=True, stdout=subprocess.PIPE).communicate()[0]
#name = s1.strip().decode('ascii')
#print(name)