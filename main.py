from tkinter import *
from tkinter import ttk
import platform

current_os = platform.system()
root = Tk()

def vulnerable_apps_window():
    apps = Toplevel(root)
    apps.title('Vulnerable Applications')
    apps.geometry('500x400')
    appsLabel = Label(apps, text='Vulnerable Applications')
    appsLabel.place(x=250, y=20)
    #TODO: Scale window according to size of table

    table = ttk.Treeview(apps, columns=('Name', 'Version'), show='headings', height=5)
    table.column('# 1', anchor=CENTER)
    table.heading('# 1', text='Name')
    table.column('# 2', anchor=CENTER)
    table.heading('# 2', text='Version')
    table.place(x=50, y=60)
    #TODO: Scale table according to data

    #Test variables
    name = ['apple', 'banana']
    version = ['00.210.21', '12.2']

    for i in range(len(name)):
        temp_name = name[i]
        temp_version = version[i]
        table.insert('', index=i, text='1', values=(temp_name, temp_version))


#TODO: Database testing window
def database_testing_window():
    test = Toplevel(root)
    test.title('Database Testing')
    test.geometry('500x400')

    access_sel = Button(test, text='Microsoft Access', width=15)
    access_sel.place(x=50, y=100)
    if current_os != 'Windows':
        access_sel['state'] = DISABLED

    mysql_sel = Button(test, text='MySQL', width=15)
    mysql_sel.place(x=50, y=120)

    sqlite_sel = Button(test, text='SQLite', width=15)
    sqlite_sel.place(x=50, y=140)

#TODO: SQL Injection development

#Quit Query
def quit_query():
    query = Toplevel(root)
    query.title('Quit')
    query.geometry('300x120')

    message_label = Label(query, text='Are you sure you want to quit?', font=('Helvetica', 12))
    message_label.place(x=40, y=10)

    message_label2 = Label(query, text='All unsaved reports will be lost')
    message_label2.place(x=60, y=40)

    quit_yes = Button(query, text='Yes', command=root.destroy, padx=18, pady=2)
    quit_yes.place(x=40, y=70)

    quit_no = Button(query, text='No', command=query.destroy, padx=18, pady=2)
    quit_no.place(x=150, y=70)


#Main Menu
root.title('Vulnerability Tool')
root.geometry('370x420')

menu_label = Label(root, text='Main Menu', font=('Helvetica', 16))
menu_label.place(x=80, y=20)

application_button = Button(root, text='Check for Vulnerable Applications', width=30, command=vulnerable_apps_window)
application_button.place(x=30, y=100)

database_button = Button(root, text='Database Penetration Testing', width=26, command=database_testing_window)
database_button.place(x=30, y=180)

quit_button = Button(root, text='Quit', width=10, command=quit_query)
quit_button.place(x=30, y=260)

root.protocol('WM_DELETE_WINDOW', quit_query)
root.mainloop()